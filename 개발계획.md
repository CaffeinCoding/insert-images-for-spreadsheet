# Insert Images For Spreadsheet - 개발 계획

## 📋 프로젝트 개요

**프로젝트명**: Insert Images For Spreadsheet (Google Sheets 확장 프로그램)  
**개발 기간**: 약 4~5주 (풀타임 1인 기준)  
**기술 스택**: Google Apps Script, HTML/CSS/JavaScript (Vanilla JS 또는 Vue.js/React)  
**난이도**: 중상

---

## 🎯 프로젝트 목표

구글 스프레드시트에 이미지를 격자형 패턴으로 배치하는 기능을 제공하는 확장 프로그램 개발

### 핵심 요구사항

- ✅ 격자형 패턴 이미지 배치
- ✅ 실시간 프리뷰 시스템
- ✅ 간격 설정 및 비활성 셀 지정
- ✅ 이미지 크기 조절 (비율 유지 포함)
- ✅ 설정값 저장 및 복구
- ✅ 에러 처리 및 진행 상황 표시

---

## 📅 Phase 1: 프로젝트 초기화 및 기본 환경 구성

**목표**: 개발 환경 설정 및 프로젝트 구조 수립  
**예상 기간**: 2~3일  
**우선순위**: 🔴 높음

### 1.1 Google Apps Script 프로젝트 생성

#### 세부 과제

- [ ] Google Apps Script 프로젝트 생성
- [ ] `appsscript.json` 설정 (권한, 매니페스트)
- [ ] HTML 파일 구조 초기화 (`sidebar.html`)
- [ ] JavaScript 진입점 (`sidebar.js`)
- [ ] CSS 기본 스타일 (`styles.css`)

#### 요구사항

```
- manifest 파일에서 필요한 권한 선언
  - spreadsheet: 스프레드시트 접근
  - script: 스크립트 실행
- Sidebar UI 로드 함수 구현 (onOpen)
```

#### 예상 결과

```
프로젝트 구조:
├── Code.gs (Apps Script 백엔드)
├── sidebar.html (UI 마크업)
├── sidebar.js (프론트엔드 로직)
└── styles.css (스타일)
```

---

### 1.2 Sidebar 기본 레이아웃 구성

#### 세부 과제

- [ ] 헤더 영역 생성 (제목, 프로젝트명)
- [ ] 상단 버튼 영역 (이미지 가져오기, 완료 버튼)
- [ ] 콘텐츠 영역 레이아웃
  - [ ] 상단: 이미지 리스트 (collapsible)
  - [ ] 중간: 설정 패널
  - [ ] 하단: 비활성 셀 지정 표
- [ ] 기본 CSS 구성 (반응형 기초)

#### UI 구성 요소

```
┌─────────────────────────────┐
│   Import Images Pattern     │  ← 헤더
├─────────────────────────────┤
│ [이미지 가져오기] | [완료]   │  ← 상단 버튼
├─────────────────────────────┤
│ ▼ 가져온 이미지 (0)         │  ← 리스트 (접힌 상태)
├─────────────────────────────┤
│ 셀 위치: [셀을 선택해주세요] │  ← 설정 패널
│ 행 개수: [  ] 열 개수: [  ] │
│ ...                         │
├─────────────────────────────┤
│ 비활성 셀 지정 ☐            │  ← 비활성 셀
│ [표 생성]                   │
└─────────────────────────────┘
```

#### 예상 결과

- Sidebar 기본 골격 완성
- 반응형 CSS 기초 설정
- 다크모드 색상 변수 정의

---

### 1.3 개발 도구 및 테스트 환경 설정

#### 세부 과제

- [ ] Google Apps Script 프로젝트 배포 테스트
- [ ] 로컬 개발 환경 구성 (clasp 사용 권장)
- [ ] 기본 console.log 디버깅 설정
- [ ] 테스트용 스프레드시트 준비

#### 예상 결과

- 개발-테스트 반복 프로세스 수립
- Sidebar 열기/닫기 동작 확인

---

## 📅 Phase 2: 핵심 기능 1 - 이미지 관리 및 기본 배치 로직

**목표**: 이미지 입력, 관리, 기본 배치 로직 구현  
**예상 기간**: 1주  
**우선순위**: 🔴 높음

### 2.1 이미지 업로드 및 리스트 관리

#### 세부 과제

- [ ] 파일 선택 다이얼로그 구현
- [ ] 이미지 파일 유효성 검증
- [ ] 이미지 메타데이터 추출 (이름, 크기, 비율)
- [ ] 이미지 리스트 상태 관리 (Array)
- [ ] 이미지 리스트 UI 렌더링
- [ ] 이미지 삭제 기능
- [ ] 총 이미지 개수 표시

#### 구현 요구사항

```javascript
// 상태 구조
interface Image {
  id: string; // 고유 ID
  name: string; // 파일명
  blob: Blob; // 이미지 데이터
  width: number; // 원본 너비
  height: number; // 원본 높이
  ratio: number; // 가로세로 비율
}

// 함수 목록
-uploadImages() -
  validateImage(file) -
  removeImage(id) -
  getImageList() -
  getTotalImageCount();
```

#### 예상 결과

- 이미지 파일 선택 기능
- 이미지 리스트 표시 및 관리
- 이미지 개수 표시

---

### 2.2 셀 선택 및 패턴 기본 설정

#### 세부 과제

- [ ] 선택한 셀 감지 (onSelectionChange 이벤트)
- [ ] 선택한 셀 좌표 표시 (A1, B2 등)
- [ ] 행/열 개수 입력 필드
- [ ] 행/열 개수 범위 제한 (예: 1~50)
- [ ] 설정값 실시간 상태 업데이트

#### 구현 요구사항

```javascript
// 상태 구조
interface PatternSettings {
  startCell: {
    row: number,
    col: number,
    address: string, // "A1" 형식
  };
  rows: number; // 패턴 행 개수
  cols: number; // 패턴 열 개수
}

// 함수 목록
-getSelectedCell() -
  updatePatternSettings(rows, cols) -
  validatePatternSettings(rows, cols) -
  getPatternCells(); // 패턴에 포함된 모든 셀 반환
```

#### 예상 결과

- 셀 선택 감지 및 표시
- 패턴 범위 설정 가능

---

### 2.3 격자형 배치 로직 (간격 포함)

#### 세부 과제

- [ ] 간격 설정 입력 필드 (행, 열)
- [ ] 배치 좌표 계산 함수
- [ ] 비활성 셀 제외 로직
- [ ] 이미지-셀 매핑 함수

#### 구현 요구사항

```javascript
// 상태 구조
interface LayoutSettings extends PatternSettings {
  rowGap: number;     // 행 간격 (셀 개수)
  colGap: number;     // 열 간격 (셀 개수)
  inactiveCell: boolean[][];  // 2D 배열
}

// 핵심 함수
- calculateLayoutPositions(
    startCell,
    rows,
    cols,
    rowGap,
    colGap,
    inactiveCells
  ): Array<{row, col}>

- mapImagesToLayout(images, positions):
    Array<{image, row, col}>
```

#### 배치 로직 예시

```
행 간격 1, 열 간격 1 (행 개수 2, 열 개수 2)
선택 셀: B1

B1 → E1 → B3 → E3

계산 방식:
위치 0 (B1): (0, 1)
위치 1 (E1): (0, 1 + 1 + 1 + 1) = (0, 4)
위치 2 (B3): (0 + 1 + 1, 1) = (2, 1)
위치 3 (E3): (2, 4)
```

#### 예상 결과

- 정확한 이미지 배치 좌표 계산
- 간격을 고려한 배치 로직

---

## 📅 Phase 3: 핵심 기능 2 - 프리뷰 시스템

**목표**: 실시간 배치 프리뷰 및 색상 시스템 구현  
**예상 기간**: 3~4일  
**우선순위**: 🔴 높음

### 3.1 프리뷰 배경색 시스템

#### 세부 과제

- [ ] 스프레드시트 셀 배경색 변경 함수
- [ ] 기존 배경색 저장 및 복구 로직
- [ ] 색상 우선순위 관리
  - [ ] 선택 셀: `#196fe1` (파란색)
  - [ ] 비활성 셀: `#7c7c7c` (회색)
  - [ ] 이미지 셀: `#269444` (초록색)
- [ ] 혼합 색상 처리 (선택 + 비활성)

#### 구현 요구사항

```javascript
// 색상 정의
const COLORS = {
  selected: "#196fe1",
  inactive: "#7c7c7c",
  image: "#269444",
  mixed: "#0d4a6d", // 선택 + 비활성 혼합
};

// 함수 목록
-setPreviewColors(imageCells, inactiveCells, selectedCell) -
  restoreOriginalColors(modifiedCells, originalColors) -
  getColorPriority(cellType);
```

#### 예상 결과

- 프리뷰 색상 적용 기능
- 기존 색상 복구 로직

---

### 3.2 debounce 및 프리뷰 갱신 로직

#### 세부 과제

- [ ] debounce 함수 구현 (0.5초)
- [ ] 설정값 변경 감지
- [ ] 프리뷰 갱신 트리거
- [ ] 프리뷰 성능 최적화 (불필요한 갱신 제거)

#### 구현 요구사항

```javascript
// 함수 목록
-debounce(func, delay) -
  onSettingChange() -
  updatePreview() -
  throttlePreviewUpdate();
```

#### 예상 결과

- 설정값 변경 시 0.5초 후 프리뷰 자동 갱신
- 과도한 API 호출 방지

---

### 3.3 선택 셀 프리뷰 시스템

#### 세부 과제

- [ ] onSelectionChange 이벤트 구현
- [ ] 선택 셀 감지 및 저장
- [ ] 선택 셀 배경색 적용
- [ ] 선택 셀 변경 시 프리뷰 갱신

#### 구현 요구사항

```javascript
// 함수 목록
-setupSelectionListener() -
  handleSelectionChange(selection) -
  updateSelectedCellPreview(newCell, oldCell);
```

#### 예상 결과

- 사용자가 셀을 재선택할 때 자동으로 표시 업데이트
- 선택 셀이 파란색으로 강조 표시

---

## 📅 Phase 4: 기능 변경 (프리뷰 제거, 셀 범위 선택) ✅

**목표**: 실시간 프리뷰 제거 및 명시적 셀 범위 선택 기능 구현  
**예상 기간**: 1~2일  
**우선순위**: 🔴 높음  
**상태**: ✅ 완료

### 4.1 프리뷰 시스템 제거

#### 완료된 작업

- [x] 실시간 프리뷰 색상 표시 제거
- [x] 프리뷰 관련 함수 제거 (getCellBackgroundColors, applyPreviewColors, clearPreviewColors)
- [x] 선택 셀 폴링 메커니즘 제거

#### 제거된 함수

```javascript
// 제거됨
function getCellBackgroundColors(cells) { ... }
function applyPreviewColors(imageCells, inactiveCells, selectedCell) { ... }
function clearPreviewColors(previewCells) { ... }
function triggerPreviewUpdate() { ... }
function triggerImmediatePreviewUpdate() { ... }
function updatePreview() { ... }
```

---

### 4.2 셀 범위 선택 기능 추가

#### 완료된 작업

- [x] 선택된 셀 좌표 실시간 반영 (setupSelectionListener 활성화, 0.5초 폴링)
- [x] 선택된 셀 입력 필드에 자동 업데이트

#### 제거된 기능

- [x] "선택" 버튼 UI 제거
- [x] handleSelectCellClick() 함수 제거
- [x] selectLayoutCells() Google Apps Script 함수 제거
- [x] 이미지 배치 위치 미리보기 기능 제거

#### 추가된 함수

```javascript
// Frontend: setupSelectionListener() - 0.5초마다 선택 셀 확인
// Frontend: updateSelectedCell() - 선택된 셀 좌표 표시
```

---

### 4.3 성능 개선

#### 완료된 작업

- [x] 폴링 간격: 300ms → 0.5초 (선택 셀만 감지)
- [x] 불필요한 색상 관리 로직 제거
- [x] 코드 복잡도 감소 (300+ 줄 제거)

---

## 📅 Phase 5: 이미지 크기 및 설정 관리 (원래 계획)

**목표**: 이미지 크기 조절 및 설정값 상태 관리  
**예상 기간**: 3~4일  
**우선순위**: 🔴 높음

### 4.1 이미지 크기 설정 UI 및 계산

#### 세부 과제

- [ ] 이미지 크기 입력 필드 (가로, 세로)
- [ ] 비율 유지 체크박스
- [ ] 셀 크기에 맞춤 체크박스
- [ ] 크기 계산 함수
- [ ] 상호 배타적 체크박스 처리

#### 구현 요구사항

```javascript
// 상태 구조
interface ImageSizeSettings {
  width: number;              // 셀 단위
  height: number;             // 셀 단위
  maintainRatio: boolean;     // 비율 유지
  fitToCell: boolean;         // 셀 크기에 맞춤
}

// 함수 목록
- calculateImageSize(
    originalWidth,
    originalHeight,
    settings,
    selectedCellSize
  ): {width, height}

- handleMaintainRatioChange(value)
- handleFitToCellChange(value)
- validateImageSize(width, height)
```

#### 크기 계산 로직

```
케이스 1 - 비율 유지, 가로만 지정
result.height = result.width / originalRatio

케이스 2 - 비율 유지, 세로만 지정
result.width = result.height * originalRatio

케이스 3 - 비율 유지, 가로/세로 모두 지정
→ 비율 유지 OFF로 변경

케이스 4 - 셀 크기에 맞춤 ON
result = selectedCellSize (비율 무시)

케이스 5 - 병합 셀 선택
result = mergedCellSize
```

#### 예상 결과

- 이미지 크기 설정 UI
- 비율/셀 크기 자동 계산
- 상호 배타적 옵션 처리

---

### 4.2 비활성 셀 지정 UI

#### 세부 과제

- [ ] 행/열 개수에 따른 표 동적 생성
- [ ] 셀 클릭 토글 기능
- [ ] 비활성 셀 상태 관리 (2D 배열)
- [ ] 다중 선택 지원
- [ ] 프리뷰에 반영

#### 구현 요구사항

```javascript
// 함수 목록
- generateInactiveCellTable(rows, cols)
- toggleInactiveCell(row, col)
- updateInactiveCellTable(inactiveCells)
- getInactiveCells(): boolean[][]
```

#### 예상 결과

- 동적 표 생성
- 셀 토글 및 다중 선택 기능
- 프리뷰에 비활성 셀 표시

---

### 4.3 상태 관리 통합

#### 세부 과제

- [ ] 전체 설정 상태 통합 관리
- [ ] 설정값 변경 감지 및 처리
- [ ] 상태 검증 함수
- [ ] 설정값 초기화 함수

#### 구현 요구사항

```javascript
// 통합 상태 구조
interface ApplicationState {
  images: Image[];
  patternSettings: PatternSettings;
  layoutSettings: LayoutSettings;
  imageSizeSettings: ImageSizeSettings;
  uiState: {
    isImageListExpanded: boolean;
    selectedCell: CellAddress;
  }
}

// 함수 목록
- getState(): ApplicationState
- setState(newState)
- validateState(): boolean
- resetSettings()
```

#### 예상 결과

- 모든 설정값이 중앙에서 관리됨
- 상태 변경 시 자동 프리뷰 갱신

---

## 📅 Phase 5: localStorage 및 고급 기능

**목표**: 설정값 저장/복구 및 고급 기능 구현  
**예상 기간**: 3~4일  
**우선순위**: 🟠 중간

### 5.1 localStorage 저장 및 복구

#### 세부 과제

- [ ] localStorage 저장 함수 구현
- [ ] localStorage 로드 함수 구현
- [ ] 저장 대상 필터링
  - [ ] 행/열 개수: YES
  - [ ] 간격 설정: YES
  - [ ] 이미지 크기: YES
  - [ ] 비활성 셀: YES (2D 배열)
  - [ ] 이미지 목록: NO
- [ ] 저장 데이터 형식 정의 (JSON)

#### 구현 요구사항

```javascript
// 저장 데이터 구조
interface SavedSettings {
  version: string; // 버전 관리용
  patternSettings: PatternSettings;
  layoutSettings: LayoutSettings;
  imageSizeSettings: ImageSizeSettings;
  savedAt: timestamp;
}

// 함수 목록
-saveSettings(state) -
  loadSettings() -
  clearSettings() -
  migrateSettings(oldSettings); // 버전 업그레이드
```

#### localStorage 키 구조

```
"importImagePattern:settings" → 저장된 설정
"importImagePattern:version" → 저장 버전
```

#### 예상 결과

- Sidebar 닫았다가 열 때 이전 설정 자동 복구
- 행/열 개수 변경 시 비활성 셀 초기화

---

### 5.2 이미지 드래그 앤 드롭 정렬

#### 세부 과제

- [ ] 드래그 앤 드롭 라이브러리 선택 및 통합
- [ ] 이미지 리스트 정렬 기능
- [ ] 정렬 상태 저장
- [ ] 기본 정렬 (파일명 오름차순)

#### 구현 요구사항

```javascript
// 라이브러리 추천: SortableJS

// 함수 목록
- initSortableList()
- handleImageReorder(oldIndex, newIndex)
- sortImagesByName()
- getImageOrder(): string[]
```

#### 예상 결과

- 이미지 드래그 앤 드롭 정렬
- 정렬된 순서대로 배치

---

### 5.3 리스트 Collapsible 기능

#### 세부 과제

- [ ] 리스트 접기/펴기 토글
- [ ] 기본 상태: 접힘
- [ ] 상태 저장 (localStorage)
- [ ] 애니메이션 처리

#### 구현 요구사항

```javascript
// 함수 목록
-toggleImageList() -
  setImageListExpanded(isExpanded) -
  saveListState(isExpanded);
```

#### 예상 결과

- 리스트 펼쳤다 접었다 가능
- 사용자 선호 상태 저장

---

## 📅 Phase 6: 이미지 삽입 및 에러 처리 (준비 중)

**목표**: 실제 이미지를 스프레드시트에 삽입하고 완전한 에러 처리
**예상 기간**: 2~3일
**우선순위**: 🔴 높음
**상태**: 🎯 준비 중

### 6.1 이미지 삽입 로직

#### 구현할 함수

- insertImages(images, startCell, settings, positions) - 이미지 배열을 지정된 위치에 삽입
- insertImageAtCell(sheet, imageUrl, row, col, width, height) - 단일 이미지 삽입
- removeInsertedImages() - Undo 기능

#### 특징

- 여러 이미지 순차 삽입
- Blob 변환 (Data URL → Blob)
- 셀 기준 크기 계산 (셀 단위를 픽셀로 변환)
- 에러 발생 시 개별 처리

---

### 6.2 진행률 표시

#### 구현할 함수

- updateProgress(current, total) - 진행률 업데이트
- showProgress() / hideProgress() - UI 표시/숨김
- showProgressError(message) - 에러 표시

#### 특징

- 실시간 진행률 바 (0% → 100%)
- 진행 상황 텍스트
- 완료/실패 상태 표시

---

### 6.3 에러 처리

#### 에러 케이스

1. **이미지 데이터 오류**

   - 잘못된 이미지 형식
   - 이미지 크기 초과
   - 데이터 손상

2. **셀 위치 오류**

   - 범위 벗어남
   - 잘못된 셀 참조

3. **권한 오류**
   - 스프레드시트 수정 불가

#### 처리 전략

- 개별 이미지 오류 무시 (다른 이미지는 계속 삽입)
- 사용자 친화적 메시지
- 상세한 콘솔 로깅

---

### 6.4 Undo/Cancel 기능

#### 구현

- 마지막 삽입한 이미지 추적
- Cancel 버튼 클릭 시 제거
- 또는 Spreadsheet.undo() 활용

---

## 📅 Phase 7: UI/UX 개선 및 최적화

**목표**: 디자인 완성 및 성능 최적화  
**예상 기간**: 2~3일  
**우선순위**: 🟡 중간

### 7.1 다크모드 구현

#### 세부 과제

- [ ] CSS 변수 정의
- [ ] 다크모드 색상 팔레트
- [ ] 미디어쿼리 적용
- [ ] 사용자 선호 설정 저장

#### 구현 요구사항

```css
/* 라이트 모드 */
:root {
  --bg-primary: #ffffff;
  --bg-secondary: #f5f5f5;
  --text-primary: #000000;
  --text-secondary: #666666;
  /* ... */
}

/* 다크 모드 */
@media (prefers-color-scheme: dark) {
  :root {
    --bg-primary: #1e1e1e;
    --bg-secondary: #2d2d2d;
    --text-primary: #ffffff;
    /* ... */
  }
}
```

#### 예상 결과

- 다크모드 완전 지원
- 시스템 설정에 따른 자동 전환

---

### 7.2 반응형 디자인 완성

#### 세부 과제

- [ ] 모바일 대응 (Sidebar 너비 제한)
- [ ] 태블릿 대응
- [ ] Flexbox/Grid 레이아웃 최적화
- [ ] 입력 필드 크기 조절

#### 구현 요구사항

```css
/* 반응형 브레이크포인트 */
@media (max-width: 768px) {
  /* 모바일 스타일 */
}

@media (min-width: 769px) {
  /* 데스크톱 스타일 */
}
```

#### 예상 결과

- 모든 화면 크기에서 최적화된 UI

---

### 7.3 성능 최적화

#### 세부 과제

- [ ] DOM 조작 최적화
- [ ] 불필요한 리렌더링 제거
- [ ] API 호출 최소화
- [ ] 이벤트 위임 구현
- [ ] 메모리 누수 방지

#### 구현 요구사항

```javascript
// 최적화 기법
- Virtual scrolling (대량 이미지)
- Event delegation
- Debounce/Throttle 활용
- 선택적 상태 업데이트
```

#### 예상 결과

- Sidebar 로딩 속도 개선
- 대량 이미지 처리 최적화

---

## 📅 Phase 8: 테스트 및 배포

**목표**: 전체 기능 테스트 및 배포  
**예상 기간**: 2~3일  
**우선순위**: 🔴 높음

### 8.1 기능 테스트

#### 테스트 항목

- [ ] 기본 이미지 배치
- [ ] 간격 설정 검증
- [ ] 비활성 셀 처리
- [ ] 이미지 크기 조절 (모든 케이스)
- [ ] 비율 유지 옵션
- [ ] 셀 크기에 맞춤
- [ ] 병합 셀 처리
- [ ] 프리뷰 색상 정확도
- [ ] localStorage 저장/복구
- [ ] 에러 처리

#### 테스트 케이스

```
TC-1: 단순 배치
- 이미지 4개, 패턴 2x2, 간격 0
- 예상: A1, B1, A2, B2에 배치

TC-2: 간격 포함
- 이미지 4개, 패턴 2x2, 행간격 1, 열간격 1
- 예상: A1, C1, A3, C3에 배치

TC-3: 비활성 셀
- 패턴 2x2, 비활성 (1,2)
- 예상: 3개 셀만 사용

TC-4: 이미지 부족
- 이미지 2개, 패턴 2x2
- 예상: 2개만 배치, 2개 빈 셀

TC-5: 이미지 초과
- 이미지 5개, 패턴 2x2 (4개)
- 예상: 4개만 배치, 1개 무시
```

#### 예상 결과

- 모든 기능이 명세대로 동작 확인
- 엣지 케이스 처리 검증

---

### 8.2 호환성 테스트

#### 테스트 항목

- [ ] Chrome/Edge/Firefox
- [ ] Google Sheets 최신 버전
- [ ] 다크모드
- [ ] 모바일 디바이스

#### 예상 결과

- 주요 브라우저에서 정상 동작 확인

---

### 8.3 배포 및 문서화

#### 세부 과제

- [ ] Google Apps Script 배포
- [ ] README.md 작성
- [ ] 사용 설명서 작성
- [ ] 기술 문서 작성

#### 배포 파일 구성

```
├── README.md           # 프로젝트 설명
├── USAGE.md           # 사용 방법
├── TECHNICAL.md       # 기술 문서
├── src/
│   ├── Code.gs
│   ├── sidebar.html
│   ├── sidebar.js
│   └── styles.css
└── package.json       # 의존성 관리
```

#### 예상 결과

- 배포 완료
- 문서화 완성

---

## 📊 Phase별 요약 및 일정

| Phase | 주제                                  | 기간  | 우선순위 | 상태    |
| ----- | ------------------------------------- | ----- | -------- | ------- |
| 1     | 프로젝트 초기화                       | 2~3일 | 🔴 높음  | ⏳ 예정 |
| 2     | 이미지 관리 + 배치 로직               | 1주   | 🔴 높음  | ⏳ 예정 |
| 3     | 프리뷰 시스템                         | 3~4일 | 🔴 높음  | ⏳ 예정 |
| 4     | 기능 변경 (프리뷰 제거, 셀 범위 선택) | 1~2일 | 🔴 높음  | ✅ 완료 |
| 5     | 이미지 크기 + 설정                    | 3~4일 | 🔴 높음  | ⏳ 예정 |
| 6     | localStorage + 고급 기능              | 3~4일 | 🟠 중간  | ⏳ 예정 |
| 7     | UI/UX 개선 + 최적화                   | 2~3일 | 🟡 중간  | ⏳ 예정 |
| 8     | 테스트 + 배포                         | 2~3일 | 🔴 높음  | ⏳ 예정 |

**총 예상 기간**: 4~5주 (풀타임 1인)

---

## 🎯 마일스톤

### Milestone 1: MVP (2주)

- ✅ Phase 1~3 완료
- ✅ 기본 이미지 배치 + 프리뷰 동작

### Milestone 2: 완전 기능 (3.5주)

- ✅ Phase 1~6 완료
- ✅ 모든 핵심 기능 동작
- ✅ 에러 처리 완료

### Milestone 3: 완성 (4~5주)

- ✅ Phase 1~8 완료
- ✅ 배포 준비 완료
- ✅ 문서화 완료

---

## 💡 개발 팁 및 주의사항

### 권장 라이브러리

```json
{
  "libraries": [
    "SortableJS - 드래그 앤 드롭용",
    "Google Apps Script API - 스프레드시트 제어"
  ]
}
```

### 주요 체크포인트

- [ ] Phase 2 배치 로직 정확도 검증 (매우 중요!)
- [ ] Phase 3 프리뷰 색상 우선순위 확인
- [ ] Phase 4 크기 계산 로직 테스트 (비율 유지 케이스)
- [ ] Phase 6 에러 처리 케이스 완벽 테스트

### 성능 고려사항

- 대량 이미지 (100개 이상) 처리 시 Virtual scrolling 고려
- 스프레드시트 API 호출 최소화 (Batch 처리)
- 프리뷰 갱신 debounce 꼭 적용

### 보안 고려사항

- 사용자 입력 값 검증 필수
- 범위 제한 (행/열 1~50 등)
- CORS 처리 (이미지 URL)

---

## 📝 추가 리소스

### Google Apps Script 문서

- [Google Apps Script 공식 문서](https://developers.google.com/apps-script)
- [Sheets API 참조](https://developers.google.com/sheets/api)

### 개발 도구

- **Clasp**: Google Apps Script 로컬 개발
- **Google Developer Console**: 프로젝트 관리
- **Apps Script Editor**: 웹 기반 개발

### 참고 코드 패턴

```javascript
// Apps Script에서 Sidebar 열기
function onOpen() {
  SpreadsheetApp.getUi()
    .createSidebarFromHtml(HtmlService.createHtmlOutput(...))
    .setWidth(300)
    .show();
}

// 셀 선택 감지
function onSelectionChange(e) {
  const range = e.source.getActiveRange();
  // 처리 로직
}

// 스프레드시트에 이미지 삽입
const image = SpreadsheetApp
  .getActiveSheet()
  .insertImage(blob, column, row);
```

---

## 🚀 시작하기

**첫 번째 작업**:

1. Google Apps Script 프로젝트 생성
2. Phase 1 초기화 시작
3. 기본 Sidebar UI 구성
4. 로컬 개발 환경 설정 (clasp)

**다음 우선순위**:

1. Phase 2 이미지 배치 로직 구현
2. Phase 3 프리뷰 시스템 테스트
3. Phase 4 이미지 크기 계산 검증

행운을 빕니다! 🎉

# Insert Images For Spreadsheet

<div align="center">

**구글 스프레드시트에 이미지를 격자형 패턴으로 배치하는 확장 프로그램**

[![Google Apps Script](https://img.shields.io/badge/Google%20Apps%20Script-4285F4?style=flat&logo=google&logoColor=white)](https://developers.google.com/apps-script)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)

[한국어](#한국어) | [English](README_EN.md)

</div>

---

## 한국어

### 📋 프로젝트 설명

구글 스프레드시트에 여러 이미지를 특정 패턴으로 자동 배치할 수 있는 확장 프로그램입니다. 이미지를 하나씩 수동으로 배치하는 번거로움 없이, 간편하게 격자형 레이아웃을 만들 수 있습니다.

### ✨ 주요 기능

#### 🎯 이미지 배치

- **격자형 패턴**: 행과 열을 지정하여 이미지를 규칙적으로 배치
- **간격 조정**: 이미지 사이의 행 간격과 열 간격을 셀 단위로 설정
- **비활성 셀**: 특정 위치에는 이미지를 배치하지 않도록 지정 가능
- **드래그 앤 드롭**: 이미지 순서를 드래그로 간편하게 변경

#### 📐 이미지 크기 조정

- **셀 크기에 맞춤**: 선택한 셀의 크기에 자동으로 맞춤 (병합 셀 지원)
- **픽셀 단위 지정**: 가로/세로 크기를 픽셀 단위로 직접 입력
- **비율 유지**: 원본 이미지의 가로세로 비율을 유지하면서 크기 조정

#### 💾 설정 관리

- **프리셋 저장**: 자주 사용하는 설정을 프리셋으로 저장하고 재사용
- **자동 저장**: 설정값이 브라우저의 localStorage에 자동 저장
- **실행 취소**: 이미지 삽입 후 취소 버튼으로 되돌리기 가능

#### 🎨 사용자 인터페이스

- **다크모드**: 시스템 설정에 따른 자동 테마 전환 지원
- **반응형 디자인**: 모바일, 태블릿, 데스크톱에 최적화된 UI
- **직관적 조작**: 스프레드시트와 유사한 디자인 스타일

### 🚀 시작하기

#### 설치 방법

1. **Google Apps Script로 직접 설치**

   ```
   1. Google 스프레드시트를 엽니다
   2. 확장 프로그램 > Apps Script 메뉴를 클릭합니다
   3. src/Code.gs 내용을 복사하여 붙여넣습니다
   4. 프로젝트 설정(⚙️) > appsscript.json 표시를 체크합니다
   5. src/appsscript.json 내용을 복사하여 붙여넣습니다
   6. 파일(+) > HTML > 'sidebar'로 파일을 생성합니다
   7. src/sidebar.html 내용을 복사하여 붙여넣습니다
   8. 저장하고 스프레드시트를 새로고침합니다
   ```

2. **Clasp를 이용한 배포 (개발자용)**

   ```bash
   # Clasp 설치
   npm install -g @google/clasp

   # Google 계정 로그인
   clasp login

   # 프로젝트 배포
   clasp push
   ```

#### 사용 방법

1. **이미지 가져오기**

   - "📁 이미지 가져오기" 버튼을 클릭하거나
   - 이미지 파일을 드래그 앤 드롭으로 추가
   - 여러 이미지를 동시에 선택 가능

2. **배치 설정**

   - 스프레드시트에서 시작 셀을 선택하고 "선택" 버튼 클릭
   - 행 개수와 열 개수를 입력 (1~50)
   - 필요시 행 간격과 열 간격을 설정 (0~20)

3. **이미지 크기 설정**

   - "셀의 크기에 맞춤" 체크: 선택한 셀 크기에 자동 맞춤
   - "이미지 비율 유지" 체크: 원본 비율을 유지하며 크기 조정
   - 직접 입력: 가로/세로 픽셀 값을 직접 지정

4. **비활성 셀 지정 (선택사항)**

   - "비활성 셀 지정" 체크박스를 활성화
   - 표에서 이미지를 배치하지 않을 셀을 클릭하여 선택

5. **적용**
   - "적용" 버튼을 클릭하여 이미지를 스프레드시트에 삽입
   - 삽입 후 "취소" 버튼으로 되돌리기 가능
   - "💾 저장" 버튼을 클릭하여 이미지 목록 초기화

### 📸 사용 예시

#### 기본 격자 배치

```
설정: 2행 × 3열, 간격 없음
결과:
[이미지1] [이미지2] [이미지3]
[이미지4] [이미지5] [이미지6]
```

#### 간격이 있는 배치

```
설정: 2행 × 2열, 행 간격 1, 열 간격 1
결과:
[이미지1] [  공백  ] [이미지2]
[  공백  ] [  공백  ] [  공백  ]
[이미지3] [  공백  ] [이미지4]
```

#### 비활성 셀 활용

```
설정: 2행 × 3열, 비활성 셀: (1,2)
결과:
[이미지1] [  공백  ] [이미지2]
[이미지3] [이미지4] [이미지5]
```

### 🔧 기술 스택

- **Google Apps Script**: 백엔드 로직 및 스프레드시트 API 연동
- **HTML/CSS/JavaScript**: 순수 Vanilla JS로 작성된 프론트엔드
- **localStorage**: 설정값 및 프리셋 저장
- **Canvas API**: 이미지 리사이징 및 최적화

### 📂 프로젝트 구조

```
insert-images-for-spreadsheet/
├── src/
│   ├── Code.gs              # Google Apps Script 백엔드
│   ├── sidebar.html         # Sidebar UI (HTML + CSS + JS)
│   └── appsscript.json      # 매니페스트 파일
├── CLASP_SETUP_GUIDE.md     # Clasp 설정 가이드
├── 개발계획.md               # 개발 계획 및 진행 상황
├── 프로젝트 명세.md          # 상세 기능 명세
├── README.md                # 이 파일 (한국어 문서)
└── README_EN.md             # 영어 문서
```

### 📝 주요 설정 옵션

| 옵션        | 설명                              | 범위 |
| ----------- | --------------------------------- | ---- |
| 행 개수     | 격자의 세로 줄 개수               | 1~50 |
| 열 개수     | 격자의 가로 줄 개수               | 1~50 |
| 행 간격     | 이미지 사이의 세로 간격 (셀 단위) | 0~20 |
| 열 간격     | 이미지 사이의 가로 간격 (셀 단위) | 0~20 |
| 이미지 너비 | 이미지의 가로 크기 (픽셀)         | 10~  |
| 이미지 높이 | 이미지의 세로 크기 (픽셀)         | 10~  |

### 🎯 활용 사례

- 📊 **제품 카탈로그**: 제품 이미지를 규칙적으로 정렬하여 카탈로그 제작
- 🖼️ **사진 앨범**: 여러 사진을 한 번에 배치하여 앨범 형식으로 정리
- 📈 **보고서 작성**: 차트나 그래프 이미지를 일정한 간격으로 배치
- 🎨 **디자인 레이아웃**: 디자인 시안을 격자 형태로 정리

### ⚠️ 주의사항

- 이미지 개수가 패턴 셀 개수보다 많으면 초과된 이미지는 무시됩니다
- 이미지 개수가 패턴 셀 개수보다 적으면 남은 셀은 비워집니다
- 비활성 셀로 인해 실제 배치 가능한 셀이 부족하면 초과된 이미지는 무시됩니다
- 병합된 셀을 선택하면 병합된 전체 크기에 이미지가 맞춰집니다
- 이미지 크기가 클수록 처리 시간이 오래 걸릴 수 있습니다

### 📄 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.

### 📧 문의

프로젝트에 대한 질문이나 제안이 있으시면 이슈를 등록해주세요.

---

<div align="center">

**Made with ❤️ for Google Sheets users**

</div>

# Insert Images For Spreadsheet

## 프로젝트 설명

구글 스프레드 시트에 이미지를 1장 또는 여러장을 특정한 패턴으로 가져오는 기능을 지원하는 구글 스프레드시트 확장 프로그램

- '패턴': 격자형(Grid)

## 기능

- 사용자가 이미지를 1장 또는 여러장을 가져온 후 선택된 셀을 기준으로 설정한 패턴에 맞게 이미지를 스프레드시트에 적용할 수 있다
- 사용자는 패턴의 범위(행, 열)을 지정할 수 있다
- 사용자는 패턴에서 이미지들의 간격(행 또는 열)을 지정할 수 있다
  - '간격': 셀 개수
- 사용자는 패턴에서 이미지가 안들어가는 부분(건너뛰기 할 부분)을 지정할 수 있다
- 사용자는 이미지의 크기를 지정된 크기 또는 선택된 셀에 맞춰 크기를 변경할 수 있다
  - 이미지의 크기 단위: 픽셀 (px)
- 사용자가 설정 값들을 변경할 경우 사용자는 실시간으로 반영된 패턴을 확인할 수 있다
- 사용자는 설정한 모든 설정 값들은 브라우저의 localstorage에 저장후 재사용할 수 있다

## 디자인

- 다크모드 지원
- 반응형 디자인 채택
- 전체적인 스타일은 스프레드시트와 유사하게 디자인
- 헤더: 프로젝트 제목 표시 (가운데)
- 상단: 이미지 가져오기 버튼 표시 (좌측) / 완료 버튼 표시 (우측)
- 콘텐츠 상단: 가져온 리스트 표시 (삭제, 순서 변경 기능 지원(드래그 앤 드롭, 기본 정렬은 파일이름 오름차순)), 리스트를 접거나 열 수 있음 (collapsible, 기본 접기 상태), 총 이미지 개수 표시
- 콘텐츠 중간: 각종 설정 표시, 사용자가 선택한 셀 위치 표시, 행 열 개수 지정, 행 간격 열 간격 개수 지정, 이미지 크기 지정 (가로 세로 각각), 이미지 크기 셀의 크기에 맞춤 체크박스, 이미지 비율 유지 체크박스 표시
- 콘텐츠 하단: 비활성 셀 지정 체크박스, 지정된 행열표 표시 및 사용자가 해당 표에 특정 셀 선택 시 해당 셀 회색 처리 (패턴 중 특정 위치 비활성화)

## 참고사항

- 이미지 개수 > 패턴 셀 개수인 경우 초과된 이미지는 무시한다
- 이미지 개수 < 패턴 셀 개수인 경우 남은 셀은 비워둔다
- 비활성 셀로 인한 실제 배치 셀 개수가 이미지 보다 부족할 경우 초과된 이미지는 무시한다
- 간격은 실제 이미지 개수 처리에 포함되지 않음
- 간격의 정의: 이미지와 이미지 사이의 행 또는 열 개수 (셀 개수)
  - 예시: 행 간격이 1 일 경우 (1행 B1열 셀 선택, (행 개수 2, 열 개수 1 설정))
    | A1 | B1 | C1 |
    |----|----|----|
    |빈칸|[img1]|빈칸|
    |빈칸|빈칸|빈칸|
    |빈칸|[img2]|빈칸|
  - 예시: 행 간격 1, 열 간격 1일 경우 (1행 B1열 셀 선택, (행 개수 2, 열 개수 2 설정))
    | A1 | B1 | C1 | D1 | E1 |
    |----|----|----|----|----|
    |빈칸|[img1]|빈칸|[img2]|빈칸|
    |빈칸|빈칸|빈칸|빈칸|빈칸|
    |빈칸|[img3]|빈칸|[img4]|빈칸|
- 단일 셀 선택: 선택된 셀이 패턴의 시작점이 된다
- 범위 선택: 범위 선택은 지원하지 않는다 (범위를 지정하기 위해 처음 선택한 셀이 선택된다)
- 프리뷰 (Phase 3에서 제거됨, Phase 4 변경)
  - Phase 3: 실제 스프레드시트에 임시로 배경색 표시
  - Phase 4: 명시적 셀 좌표 표시로 변경
- 선택된 셀 좌표 반영 (Phase 4)
  - 사용자가 스프레드시트에서 셀을 클릭하면 사이드바의 "선택된 셀" 필드에 자동으로 반영
  - 반영 주기: 0.5초마다 확인 (폴링)
  - 사용자에게 미리 이미지가 삽입될 위치를 안내하지 않음 (완료 버튼 클릭 시 이미지 삽입)
- 이미지 비율 유지 옵션 동작 방식
  - 가로만 지정: 비율에 맞게 세로 자동 계산
  - 세로만 지정: 비율에 맞게 가로 자동 계산
  - 가로/세로 둘 다 지정: 비율 유지 off 상태로 변경
- 셀의 크기에 맞춤과 비율 유지는 동시에 ON이 될 수 없음
  - 셀의 크기에 맞춤 ON 시 비율 유지 OFF / 비율 유지 ON 시 셀에 맞춤 OFF
  - 기본 설정 셀의 크기에 맞춤
- 셀의 크기에 맞춤 옵션의 경우 선택한 단일 셀의 가로 세로 크기에 이미지 크기를 맞춤
  - 패턴에 포함된 셀 중 선택한 셀의 가로 세로 크기와 다를 경우 무시 (선택한 셀이 기준, 이미지 크기 계산에만 사용)
  - 병합된 셀을 선택할 경우 병합된 셀의 가로 세로 전체크기에 이미지 크기를 맞춤 (병합된 셀을 단일 셀로 처리)
  - 사용자가 셀 크기를 변경할 경우 삽입된 위치의 이미지 크기도 자동 조정
- 선택한 셀의 경우 프리뷰에서 해당 셀의 배경색을 '#196fe1'으로 변경, 기존 배경색이 존재할 경우 덮어씌우고 완료된 이후 기존 배경색으로 변경
- 사용자가 셀을 재선택할 경우 자동으로 업데이트됨 (onSelectionChange 이벤트 사용, 속도 debounce (0.5초 정도))
- 완료 버튼
  - 선택한 셀이 없을 경우 비활성화 (선택한 셀 표시하는 부분에 '셀을 선택해주세요' 표시)
  - 가져온 이미지가 없을 경우 비활성화
  - 완료 버튼 클릭 시
    - 헤더 하단에 progress 표시
    - 실제 스프레드시트에 이미지 삽입
    - 완료 버튼 좌측에 취소 버튼 표시
    - 완료 버튼 -> 저장 버튼으로 변경
  - 저장 버튼 클릭 시
    - 가져온 이미지들 초기화
    - 취소 버튼 비표시
    - 저장 버튼 -> 완료 버튼으로 변경
- 취소 버튼
  - 취소 버튼 클릭 시
    - 이미지 삽입 취소
    - 프리뷰 표시
    - 설정값 유지
    - 저장 버튼 -> 완료 버튼으로 변경
    - 스프레드시트의 undo 기능 활용으로 취소 가능, 제한 시간 없음
- Progress 표시 방식
  - 정확한 위치: sidebar 헤더 하단에 표시
  - 업데이트 빈도: 각 이미지 마다 업데이트
  - 진행률 막대 형태
  - 모든 이미지 삽입 후 100% 표시
  - 기본 프로그래스 색상 '#196fe1'으로 표시
  - 에러 발생 시 프로그래스 색상 '#d9372a'으로 표시
  - 에러 발생 시 전체 프로세스 중단
  - 모든 이미지 삽입 완료 후 자동 사라짐 (100% 달성 후 1초 지연하여 사라짐)
- localStorage 저장 범위
  - 이미지 목록 및 데이터: NO
  - 행/열 개수: YES
  - 간격 설정: YES
  - 이미지 크기: YES
  - 비활성 셀: YES
  - 비활성 셀의 경우 2D 배열 방식으로 저장
  - 행/열 개수 변경 시 비활성 셀은 초기화
  - sidebar 열 때 자동으로 localStorage 데이터 복구
- 비활성화 셀 선택 방식
  - 표에서 클릭을 이용해 비활성화할 셀을 선택
    - 예를 들어: 행 개수 2, 열 개수 3 일 경우
      - 2행 3열 표 생성됨
      - 사용자가 1행 2열의 셀을 비활성화 셀로 선택
      - 표에서 해당 셀 배경색 '#7c7c7c' 지정
      - 프리뷰에서 동일한 순서의 셀 비활성화 지정
  - 선택한 비활성화 셀을 다시 한번 클릭으로 활성화 가능 (클릭 토글 방식)
  - 다중 선택 지원
- 에러처리
  - 이미지 로드 실패 시
    - 로드가 실패한 이미지 이름을 프로그래스 하단에 표시 ("실패한 이미지 1/10" 형태로 표시)
    - 전체 프로세스 중단
